#  geom_line(aes(color=disability))+
# facet_wrap(~year)
# Chunk 9
#this is more in line with the BC graphing
#ggplot(fresh_primo, aes(year, frequency))+
# geom_smooth(color = "cornflowerblue") +
# theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
#  facet_wrap(~disability)
ggplot(fresh_primo, aes(age, frequency))+
geom_line(aes(color=disability))+
facet_wrap(~year)+
labs(color="Dance Party")
ggplot(fresh_primo, aes(age, frequency))+
geom_line(aes(color=disability))+
facet_wrap(~year)+
labs(color="Disability")
primodata <- read_excel(here("data", "primo_merged_oregon_data.xlsx"))
cleanest_primo <-primodata %>%
remove_empty(which = c("rows", "cols")) %>%
clean_names()
cleanest_primo <- cleanest_primo %>%
select(-six_to_twentyone_total, -x24)
cleanest_primo2 <- cleanest_primo [!(cleanest_primo$disability=="TOTAL (SUM OF ALL OF THE ABOVE)" |cleanest_primo$disability=="OTHER HEALTH IMPAIRMENT" | cleanest_primo$disability=="SPECIFIC LEARNING DISABILITY" | cleanest_primo$disability=="SPECIFIC LEARNING DISABILITY"),]
cleanest_primo2
fresh_primo <- cleanest_primo2 %>%
pivot_longer(starts_with("x"), names_to = "age", values_to = "frequency") %>%
mutate(age = parse_number(age),
year = parse_number(year))
fresh_primo %>%
group_by(year, disability) %>%
summarize(total=sum(frequency, na.rm=TRUE))
# Chunk 1: setup
library("papaja")
r_refs("r-references.bib")
library(here)
library(tidyverse)
library("readxl")
library(janitor)
BCdata <- read_excel(here("data", "bcsped_headcount.xlsx"))
BCdatastripped <- BCdata %>%
select("SCHOOL_YEAR",
"DATA_LEVEL",
"SPECIAL_NEEDS_CODE",
"NUMBER_OF_STUDENTS",
"PUBLIC_OR_INDEPENDENT") %>%
filter(DATA_LEVEL == "PROVINCE LEVEL",
PUBLIC_OR_INDEPENDENT == "PROVINCE - Total")
# Chunk 2: sandbox
library(here)
library(tidyverse)
library("readxl")
BCdata <- read_excel(here("data", "bcsped_headcount.xlsx"))
BCdatastripped <- BCdata %>%
select("SCHOOL_YEAR",
"DATA_LEVEL",
"SPECIAL_NEEDS_CODE",
"NUMBER_OF_STUDENTS",
"PUBLIC_OR_INDEPENDENT",
"DISTRICT_NUMBER") %>%
mutate(SPECIAL_NEEDS_CODE = fct_recode(SPECIAL_NEEDS_CODE,
"Physically Dependent" = "A",
"Deafblind" = "B",
"Moderate+ ID" = "C",
"Chronic Health Impairment" = "D",
"Visual Impairment" = "E",
"Deaf or Hard of Hearing" = "F",
"Autism" = "G",
"Intensive Behavioural Need" = "H",
"Mild ID" = "K",
"Learning Disability" = "Q",
"Gifted" = "P",
"Mild Behavioural Need" = "R"),
SCHOOL_YEAR = as.factor(SCHOOL_YEAR),
NUMBER_OF_STUDENTS = as.integer(NUMBER_OF_STUDENTS),
SCHOOL_YEAR = as.numeric(SCHOOL_YEAR)) %>%
filter(DATA_LEVEL == "PROVINCE LEVEL",
PUBLIC_OR_INDEPENDENT == "PROVINCE - Total",
SCHOOL_YEAR >= 7,
SPECIAL_NEEDS_CODE != "M",
SPECIAL_NEEDS_CODE != "J",
SPECIAL_NEEDS_CODE != "N")
ggplot(BCdatastripped, aes(x = SCHOOL_YEAR, y = NUMBER_OF_STUDENTS)) +
geom_line(color = "cornflowerblue") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
facet_wrap(~SPECIAL_NEEDS_CODE) +
labs(title = "BC Provincial Headcount of Students with Exceptionalities by Category",
x = "School Year",
y = "Headcount")
# Chunk 3: urban vs. rural
bc_data_district_classification <- read_excel(here("data", "bc_data_district_classification.xlsx"))
district_class <- bc_data_district_classification %>%
select("SCHOOL_YEAR",
"DATA_LEVEL",
"PUBLIC_OR_INDEPENDENT",
"DISTRICT_NUMBER",
"DISTRICT_NAME",
"DISTRICT_POPULATION_2016",
"DISTRICT_CLASSIFICATION",
"SPECIAL_NEEDS_CODE",
"NUMBER_OF_STUDENTS") %>%
filter(DATA_LEVEL == "DISTRICT LEVEL",
PUBLIC_OR_INDEPENDENT == "BC Public School") %>%
pivot_longer(DISTRICT_CLASSIFICATION, values_drop_na = TRUE, values_to = "DISTRICT_CLASSIFICATION") %>%
select(-"name")
# Chunk 4: District Census Population Table
# Chunk 5: cleaning Oregon data
primodata <- read_excel(here("data", "primo_merged_oregon_data.xlsx"))
cleanest_primo <-primodata %>%
remove_empty(which = c("rows", "cols")) %>%
clean_names()
cleanest_primo <- cleanest_primo %>%
select(-six_to_twentyone_total, -x24)
cleanest_primo2 <- cleanest_primo [!(cleanest_primo$disability=="TOTAL (SUM OF ALL OF THE ABOVE)" |cleanest_primo$disability=="OTHER HEALTH IMPAIRMENT" | cleanest_primo$disability=="SPECIFIC LEARNING DISABILITY" | cleanest_primo$disability=="SPECIFIC LEARNING DISABILITY"),]
cleanest_primo2
fresh_primo <- cleanest_primo2 %>%
pivot_longer(starts_with("x"), names_to = "age", values_to = "frequency") %>%
mutate(age = parse_number(age),
year = parse_number(year))
fresh_primo %>%
group_by(year, disability) %>%
summarize(total=sum(frequency, na.rm=TRUE))
# Chunk 6: Oregon plot
ggplot(fresh_primo, aes(age, frequency))+
geom_line(aes(color=disability))+
facet_wrap(~year)
# Chunk 7
#hiding this for now
fresh_primo %>%
filter(disability=="AUTISM") %>%
ggplot(aes(age, frequency))+
geom_line(aes(color=disability))+
facet_wrap(~year)
# Chunk 8
#this is more in line with the BC graphing
ggplot(fresh_primo, aes(year, frequency))+
geom_smooth(color = "cornflowerblue") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
facet_wrap(~disability)
ggplot(fresh_primo, aes(age, frequency))+
geom_line(aes(color=disability))+
facet_wrap(~year)
ggplot(fresh_primo, aes(age, frequency))+
geom_line(aes(color=disability))
facet_wrap(~year)+
+ labs (color = "disability")
ggplot(fresh_primo, aes(age, frequency))+
geom_line(aes(color=disability))
facet_wrap(~year)+
+ labs (color = "Disability")
ggplot(fresh_primo, aes(age, frequency))+
geom_line(aes(color=disability))
facet_wrap(~year)
+ labs (color = "Disability")
ggplot(fresh_primo, aes(age, frequency))+
geom_line(aes(color=disability))
facet_wrap(~year)
ggplot(fresh_primo, aes(age, frequency))+
geom_line(aes(color=disability))+
facet_wrap(~year)+
labs(color="Disability")
ggplot(fresh_primo, aes(age, frequency))+
geom_line(aes(color=disability))
facet_wrap(~year)+
labs(color="Diability")
ggplot(fresh_primo, aes(age, frequency))+
geom_line(aes(color=disability))
facet_wrap(~year)+
labs(color="Disability")
ggplot(fresh_primo, aes(age, frequency))+
geom_line(aes(color=disability))
facet_wrap(~year)+
labs(color="Disability")
ggplot(fresh_primo, aes(age, frequency))+
geom_line(aes(color=disability))+
facet_wrap(~year)+
labs(color="Disability")
ggplot(fresh_primo, aes(age, frequency))+
geom_line(aes(color=disability))+
facet_wrap(~year)+
labs(color="Disability")
ggplot(fresh_primo, aes(age, frequency))+
geom_line(aes(color=disability))+
facet_wrap(~year)+
labs(color="Disability") +(x= "Student Age")
ggplot(fresh_primo, aes(age, frequency))+
geom_line(aes(color=disability))+
facet_wrap(~year)+
labs(color="Disability") +(x= "Student Age")
ggplot(fresh_primo, aes(age, frequency))+
geom_line(aes(color=disability))+
facet_wrap(~year)+
labs(color="Disability", x= "Student Age")
ggplot(fresh_primo, aes(age, frequency))+
geom_line(aes(color=disability))+
facet_wrap(~year)+
labs(color="Disability", x= "Student Age", y="Student Count")
#this is more in line with the BC graphing
ggplot(fresh_primo, aes(year, frequency))+
geom_smooth(color = "cornflowerblue") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
facet_wrap(~disability)
#this is more in line with the BC graphing
ggplot(fresh_primo, aes(year, frequency))+
geom_smooth(color = "cornflowerblue") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
facet_wrap(~disability)+
labs(color="frequency", x= "Year", y="Student Count", Title = "Trends in Frequency")
#this is more in line with the BC graphing
ggplot(fresh_primo, aes(year, frequency))+
geom_smooth(color = "cornflowerblue") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
facet_wrap(~disability)+
labs(color="frequency", x= "Year", y="Student Count", title = "Trends in Frequency")
ggplot(fresh_primo, aes(age, frequency))+
geom_line(aes(color=disability))+
facet_wrap(~year)+
labs(color="Disability", x= "Student Age", y="Student Count", title ="Disability Counts Over Time)
ggplot(fresh_primo, aes(age, frequency))+
geom_line(aes(color=disability))+
facet_wrap(~year)+
labs(color="Disability", x= "Student Age", y="Student Count", title ="Disability Counts Over Time")
ggplot(fresh_primo, aes(age, frequency))+
geom_line(aes(color=disability))+
facet_wrap(~year)+
labs(color="disability", x= "Student Age", y="Student Count", title ="Disability Counts Over Time")
ggplot(fresh_primo, aes(age, frequency))+
geom_line(aes(color=disability))+
facet_wrap(~year)+
labs(color="disability", x= "Student Age", y="Student Count", title ="Disability Prevalence By Age")
library("papaja")
r_refs("r-references.bib")
library(here)
library(tidyverse)
library("readxl")
library(janitor)
library(dplyr)
BCdata <- read_excel(here("data", "bcsped_headcount.xlsx"))
BCdatastripped <- BCdata %>%
select("SCHOOL_YEAR",
"DATA_LEVEL",
"SPECIAL_NEEDS_CODE",
"NUMBER_OF_STUDENTS",
"PUBLIC_OR_INDEPENDENT") %>%
filter(DATA_LEVEL == "PROVINCE LEVEL",
PUBLIC_OR_INDEPENDENT == "PROVINCE - Total")
library(here)
library(tidyverse)
library("readxl")
BCdata <- read_excel(here("data", "bcsped_headcount.xlsx"))
BCdatastripped <- BCdata %>%
select("SCHOOL_YEAR",
"DATA_LEVEL",
"SPECIAL_NEEDS_CODE",
"NUMBER_OF_STUDENTS",
"PUBLIC_OR_INDEPENDENT",
"DISTRICT_NUMBER") %>%
mutate(SPECIAL_NEEDS_CODE = fct_recode(SPECIAL_NEEDS_CODE,
"Physically Dependent" = "A",
"Deafblind" = "B",
"Moderate+ ID" = "C",
"Chronic Health Impairment" = "D",
"Visual Impairment" = "E",
"Deaf or Hard of Hearing" = "F",
"Autism" = "G",
"Intensive Behavioural Need" = "H",
"Mild ID" = "K",
"Learning Disability" = "Q",
"Gifted" = "P",
"Mild Behavioural Need" = "R"),
SCHOOL_YEAR = as.factor(SCHOOL_YEAR),
NUMBER_OF_STUDENTS = as.integer(NUMBER_OF_STUDENTS),
SCHOOL_YEAR = as.numeric(SCHOOL_YEAR)) %>%
filter(DATA_LEVEL == "PROVINCE LEVEL",
PUBLIC_OR_INDEPENDENT == "PROVINCE - Total",
SCHOOL_YEAR >= 7,
SPECIAL_NEEDS_CODE != "M",
SPECIAL_NEEDS_CODE != "J",
SPECIAL_NEEDS_CODE != "N")
ggplot(BCdatastripped, aes(x = SCHOOL_YEAR, y = NUMBER_OF_STUDENTS)) +
geom_line(color = "cornflowerblue") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
facet_wrap(~SPECIAL_NEEDS_CODE) +
labs(title = "BC Provincial Headcount of Students with Exceptionalities by Category",
x = "School Year",
y = "Headcount")
# Making student number column numeric
x <- c(10)
BCdata[ , x] <- apply(BCdata[ , x], 2,
function(x)as.numeric(as.character(x)))
#
bc_data_district_classification <- read_excel(here("data", "bc_data_district_classification.xlsx"))
district_class <- bc_data_district_classification %>%
select("SCHOOL_YEAR",
"DATA_LEVEL",
"PUBLIC_OR_INDEPENDENT",
"DISTRICT_NUMBER",
"DISTRICT_NAME",
"DISTRICT_POPULATION_2016",
"DISTRICT_CLASSIFICATION",
"SPECIAL_NEEDS_CODE",
"NUMBER_OF_STUDENTS") %>%
filter(DATA_LEVEL == "DISTRICT LEVEL",
PUBLIC_OR_INDEPENDENT == "BC Public School") %>%
pivot_longer(DISTRICT_CLASSIFICATION, values_drop_na = TRUE, values_to = "DISTRICT_CLASSIFICATION") %>%
select(-"name")
#Attempting to make columns numeric
view(district_class) #Need cols 6 & 8
x <- c(6,8)
district_class[ , x] <- apply(district_class[ , x], 2,
function(x)as.numeric(as.character(x)))
#
#Data Prep
census_data <- district_class %>%
janitor::clean_names() %>%
group_by(district_name, district_number) %>%
mutate(est_students = sum(number_of_students, na.rm = TRUE)) %>%
select(-c("school_year",
"data_level",
"public_or_independent",
"special_needs_code",
"number_of_students")) %>%
distinct()
#Table
apa_table(
census_data,
digits = 0,
caption = "District Classification by Population According to 2016 Census",
note = "Number of students is estimated and does not include masked data.",
col.names = c("District Number",
"District Name",
"Population",
"Classification",
"Number of Students")
)
#Data Prep
rural_districts <- district_class %>%
janitor::clean_names() %>%
filter(district_classification == "Rural") %>%
select(-c("data_level",
"public_or_independent",
"district_population_2016"))
#Viz - Totals by Code
ggplot(rural_districts,
aes(special_needs_code, number_of_students,
color = special_needs_code)) +
geom_line() +
facet_wrap(~school_year) +
labs(title = "Total Students by Exceptionality",
x = "Exceptionality",
y = "Number of Students")
#Data for Rural Totals (No categories)
rural_totals <- rural_districts %>%
group_by(school_year, district_name, district_number) %>%
mutate(students = sum(number_of_students, na.rm = TRUE)) %>%
select(-c(special_needs_code, district_classification, number_of_students)) %>%
distinct()
#Data Viz Totals/Time
ggplot(rural_totals, aes(school_year, students)) +
geom_col(aes(color = district_name)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
#What's going on with Prince George? Why is there such a steep drop in 2006?
pg <- rural_districts %>%
filter(district_name == "Prince George") %>%
as_tibble()
pg_sums <- pg %>%
group_by(school_year) %>%
mutate(student = sum(number_of_students, na.rm = TRUE)) %>%
select(-c(district_number, special_needs_code, district_classification, number_of_students)) %>%
distinct()
#What's happening by Dx?
pg_dx_sum <- pg %>%
group_by(school_year, special_needs_code) %>%
mutate(student = sum(number_of_students, na.rm = TRUE)) %>%
select(-c(district_number, district_classification, number_of_students)) %>%
distinct()
ggplot(pg_dx_sum, aes(school_year, student)) +
geom_col() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
facet_wrap(~special_needs_code)
#What's going on with gifted?????
pg_gifted <- pg %>%
filter(special_needs_code == "P") %>%
select(-c(district_number, district_classification))
ggplot(pg_gifted, aes(school_year, number_of_students)) +
geom_col() +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
##Looking into Sooke (SD 62 - pop. 9,269) categorized under Victoria so urban but technically rural
## In progress
sooke <- district_class %>%
filter(DISTRICT_NAME == "Sooke") %>%
as_tibble()
ggplot(sooke, aes(SPECIAL_NEEDS_CODE)) +
facet_wrap(~SCHOOL_YEAR)
geom_col()
pg_sums <- pg %>%
group_by(school_year) %>%
mutate(student = sum(number_of_students, na.rm = TRUE)) %>%
select(-c(district_number, special_needs_code, district_classification, number_of_students)) %>%
distinct()
#Data Prep
rural_districts <- district_class %>%
janitor::clean_names() %>%
filter(district_classification == "Rural") %>%
select(-c("data_level",
"public_or_independent",
"district_population_2016"))
#Viz - Totals by Code
ggplot(rural_districts,
aes(special_needs_code, number_of_students,
color = special_needs_code)) +
geom_line() +
facet_wrap(~school_year) +
labs(title = "Total Students by Exceptionality",
x = "Exceptionality",
y = "Number of Students")
#Data for Rural Totals (No categories)
rural_totals <- rural_districts %>%
group_by(school_year, district_name, district_number) %>%
mutate(students = sum(number_of_students, na.rm = TRUE)) %>%
select(-c(special_needs_code, district_classification, number_of_students)) %>%
distinct()
#Data Viz Totals/Time
ggplot(rural_totals, aes(school_year, students)) +
geom_col(aes(color = district_name)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
#What's going on with Prince George? Why is there such a steep drop in 2006?
pg <- rural_districts %>%
filter(district_name == "Prince George") %>%
as_tibble()
pg_sums <- pg %>%
group_by(school_year) %>%
mutate(student = sum(number_of_students, na.rm = TRUE)) %>%
select(-c(district_number, special_needs_code, district_classification, number_of_students)) %>%
distinct()
#What's happening by Dx?
pg_dx_sum <- pg %>%
group_by(school_year, special_needs_code) %>%
mutate(student = sum(number_of_students, na.rm = TRUE)) %>%
select(-c(district_number, district_classification, number_of_students)) %>%
distinct()
ggplot(pg_dx_sum, aes(school_year, student)) +
geom_col() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
facet_wrap(~special_needs_code)
#What's going on with gifted?????
pg_gifted <- pg %>%
filter(special_needs_code == "P") %>%
select(-c(district_number, district_classification))
ggplot(pg_gifted, aes(school_year, number_of_students)) +
geom_col() +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
##Looking into Sooke (SD 62 - pop. 9,269) categorized under Victoria so urban but technically rural
## In progress
sooke <- district_class %>%
filter(DISTRICT_NAME == "Sooke") %>%
as_tibble()
ggplot(sooke, aes(SPECIAL_NEEDS_CODE)) +
facet_wrap(~SCHOOL_YEAR)
geom_col()
ggplot(pg_gifted, aes(school_year, number_of_students)) +
geom_col() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(title = "Gifted Students in Prince George 1999-2020",
subtitle = "Note: Totals under 10 are masked by district in reporting."
x = "School Year",
ggplot(pg_gifted, aes(school_year, number_of_students)) +
geom_col() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
labs(title = "Gifted Students in Prince George 1999-2020",
subtitle = "Note: Totals under 10 are masked by district in reporting.",
x = "School Year",
y = "Total Students")
ggplot(pg_dx_sum, aes(school_year, student)) +
geom_col() +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
facet_wrap(~special_needs_code)
sooke <- district_class %>%
filter(DISTRICT_NAME == "Sooke") %>%
as_tibble()
#Data Prep
urban_districts <- district_class %>%
janitor::clean_names() %>%
filter(district_classification == "Urban") %>%
select(-c("data_level",
"public_or_independent",
"district_population_2016"))
urban_totals <- urban_districts %>%
group_by(school_year, district_name, district_number) %>%
mutate(students = sum(number_of_students, na.rm = TRUE)) %>%
select(-c(special_needs_code, district_classification, number_of_students)) %>%
distinct()
#Data Viz Totals/Time
ggplot(urban_totals, aes(school_year, students)) +
geom_col(aes(color = district_name)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
#Viz - Totals by Code
ggplot(urban_districts,
aes(special_needs_code, number_of_students,
color = special_needs_code)) +
geom_line() +
facet_wrap(~school_year) +
labs(title = "Total Students by Exceptionality",
x = "Exceptionality",
y = "Number of Students")
#Data Viz Totals/Time
ggplot(urban_totals, aes(school_year, students)) +
geom_col(aes(color = district_name)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
#Data Viz Totals/Time
ggplot(rural_totals, aes(school_year, students)) +
geom_col(aes(color = district_name)) +
theme(axis.text.x = element_text(angle = 90, hjust = 1))
